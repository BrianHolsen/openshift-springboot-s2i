#!/bin/bash -e
#
# S2I assemble script for the 'openshift-springboot-s2i' image.
# The 'assemble' script builds your application source ready to run.
#
# For more information refer to the documentation:
#  https://github.com/openshift/source-to-image/blob/master/docs/builder_image.md
#

export PATH=$JAVA_HOME/bin:$M2_HOME/bin:$PATH

echo "---> Installing application source"

cd /tmp/src

echo "PATH = $PATH"

echo "---> Running maven packaging"
mvn clean package

echo "---> Creating deployments directory and copying JARs over"
mkdir /deployments
cp -f /tmp/src/target/*jar /deployments/application.jar

rm -rf /tmp/*
chmod -R 755 /deployments